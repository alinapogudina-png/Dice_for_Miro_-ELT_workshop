<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Tool</title>
    <style>
        :root {
            --dice-background-color: #574FFF; /* Background for regular dice */
            --number-color: #FFFFFF; /* Color for dice numbers */
            --neon-color: #00FFFF;
        }
        html, body {
            width: 100vw;
            height: 100vh;
            margin: 0; padding: 0;
            overflow: hidden;
        }
        body {
            background-color: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            -webkit-user-select: none; /* Disable text selection */
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .tool-container {
            width: 80%; 
            height: 80%;
            max-width: 150px; 
            max-height: 150px;
            position: relative;
            box-sizing: border-box; 
            display: flex; 
            justify-content: center;
            align-items: center;
            box-shadow: none; 
            transition: box-shadow 0.3s ease-out; /* Smooth neon transition */
        }
        .tool-container.neon {
            box-shadow: 0 0 10px var(--neon-color), 0 0 25px var(--neon-color), 0 0 50px var(--neon-color);
        }

        /* --- Dice specific styles --- */
        .dice-style {
            background-color: var(--dice-background-color);
            border-radius: 20%;
            width: 100%; height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s ease-out;
        }

        .dice-number {
            color: var(--number-color); 
            font-size: 8vw; 
            min-font-size: 40px; 
            font-weight: bold;
            line-height: 1; 
            display: block; 
            animation: bounce 0.5s ease-out;
            transition: color 0.3s ease-out;
        }

        /* --- Wooden Dice specific styles --- */
        .wood-style {
            background-image: url('https://www.transparenttextures.com/patterns/wood-pattern.png'); /* Public domain wood texture */
            background-size: cover;
            background-color: transparent; /* Ensure wood texture is visible */
            border: none;
            border-radius: 20%;
            width: 100%; height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .wood-style .dice-number {
            color: #FFFFFF; /* White dots for wooden dice */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5); /* For better contrast on wood */
        }

        /* --- Coin specific styles --- */
        .coin-style {
            width: 100%; height: 100%;
            border-radius: 50%; /* Round shape for coin */
            background-color: transparent; /* Background managed by image */
            overflow: hidden; /* To keep image within bounds */
        }
        .coin-style img {
            width: 100%; height: 100%;
            object-fit: contain; /* Scale image to fit, maintain aspect ratio */
            display: block;
            animation: coinFlipAnim 0.3s ease-out; /* Simple flip animation */
        }

        @keyframes bounce {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes coinFlipAnim {
            0% { transform: rotateY(0deg) scale(0.8); opacity: 0; }
            100% { transform: rotateY(360deg) scale(1); opacity: 1; }
        }

        /* Responsive font size adjustments for very small containers */
        @media (max-width: 150px) {
             .dice-number { font-size: 50px; }
        }
        @media (max-width: 100px) {
             .dice-number { font-size: 30px; }
        }
    </style>
</head>
<body>
    <div id="tool" class="tool-container">
        <!-- Content will be dynamically loaded/swapped by JS -->
    </div>

    <audio id="soundEffect" src="https://files.catbox.moe/xk6v0c.mp3" preload="auto"></audio>

    <script>
        const toolContainer = document.getElementById('tool');
        const soundEffect = document.getElementById('soundEffect');
        let isRolling = false;
        let enableSound = false;
        
        // Coin images
        const coinImages = {
            heads: 'https://www.svgrepo.com/show/368551/coin-heads-obverse.svg', // Public domain SVG
            tails: 'https://www.svgrepo.com/show/368552/coin-tails-reverse.svg'   // Public domain SVG
        };

        function applySettings() {
            const params = new URLSearchParams(window.location.search);
            const root = document.documentElement;

            const isCoin = params.get('coin') === 'true';
            const isWood = params.get('wood') === 'true';
            
            // Clear existing content and classes
            toolContainer.innerHTML = '';
            toolContainer.classList.remove('neon', 'dice-style', 'wood-style', 'coin-style');

            // Apply neon effect
            if (params.get('neon') === 'true') {
                toolContainer.classList.add('neon');
                root.style.setProperty('--neon-color', params.get('neonColor') || '#00FFFF');
            }

            enableSound = params.get('sound') === 'true';

            if (isCoin) {
                // --- Coin setup ---
                toolContainer.classList.add('coin-style');
                const coinImage = document.createElement('img');
                coinImage.id = 'coinImage';
                coinImage.src = coinImages.heads; // Default to heads
                toolContainer.appendChild(coinImage);
            } else if (isWood) {
                // --- Wooden Dice setup ---
                toolContainer.classList.add('wood-style');
                const diceNumberSpan = document.createElement('span');
                diceNumberSpan.id = 'diceNumber';
                diceNumberSpan.classList.add('dice-number');
                diceNumberSpan.textContent = '1';
                toolContainer.appendChild(diceNumberSpan);
                root.style.setProperty('--dice-background-color', 'transparent'); // Overridden by image
                root.style.setProperty('--number-color', '#FFFFFF'); // Fixed white for wood
            } else {
                // --- Regular Dice setup ---
                toolContainer.classList.add('dice-style');
                const diceNumberSpan = document.createElement('span');
                diceNumberSpan.id = 'diceNumber';
                diceNumberSpan.classList.add('dice-number');
                diceNumberSpan.textContent = '1';
                toolContainer.appendChild(diceNumberSpan);

                root.style.setProperty('--dice-background-color', params.get('diceColor') || '#574FFF');
                root.style.setProperty('--number-color', params.get('numberColor') || '#FFFFFF');
            }
        }

        function rollTool() {
            if (isRolling) return;
            isRolling = true;

            // Play sound if enabled
            if (enableSound) {
                soundEffect.currentTime = 0; // Reset sound to start
                soundEffect.play().catch(e => console.warn("Failed to play sound:", e));
            }

            if (toolContainer.classList.contains('coin-style')) {
                // --- Coin flip logic ---
                const coinImage = document.getElementById('coinImage');
                const randomSide = Math.random() < 0.5 ? 'heads' : 'tails';
                
                coinImage.style.animation = 'none'; // Reset animation
                void coinImage.offsetWidth; // Trigger reflow
                coinImage.style.animation = `coinFlipAnim 0.3s ease-out`;

                coinImage.src = coinImages[randomSide];
                setTimeout(() => {
                    isRolling = false;
                }, 300); // Animation duration
            } else {
                // --- Dice roll logic ---
                const diceNumberSpan = document.getElementById('diceNumber');
                const randomValue = Math.floor(Math.random() * 6) + 1; // 1 to 6
                
                diceNumberSpan.style.animation = 'none'; // Reset animation
                void diceNumberSpan.offsetWidth; // Trigger reflow
                diceNumberSpan.style.animation = `bounce 0.5s ease-out`; // Fixed animation duration

                diceNumberSpan.textContent = randomValue;
                setTimeout(() => {
                    isRolling = false;
                }, 500); // Animation duration
            }
        }

        // Event Listeners
        toolContainer.addEventListener('click', rollTool);

        // Initial setup
        applySettings();
        // Initial roll with a slight delay
        setTimeout(() => {
            rollTool();
        }, 50); 
    </script>
</body>
</html>
